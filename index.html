<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#1a0b2e" />
  <title>Aula Corporativa - Acceso Seguro</title>

  <style>
    /* ═══════════════════════════════════════════════════════════
       VARIABLES CSS - Tenant Override System
    ═══════════════════════════════════════════════════════════ */
:root {
      /* Estilos estructurales (no cambian) */
      --shadow-sm: 0 4px 16px rgba(0, 0, 0, 0.2);
      --shadow-lg: 0 20px 60px rgba(0, 0, 0, 0.4);
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 20px;
      --transition-fast: 180ms cubic-bezier(0.4, 0, 0.2, 1);
      --transition-smooth: 350ms cubic-bezier(0.4, 0, 0.2, 1);
      --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;

      /* Variables "Maestras" (controladas por tenants.json) */
      --primaryColor: #234B95;
      --secondaryColor: #1F3F7A;
      
      --bgPage: #141E30;
      --textPage: #ffffff;
      
      --bgBrand: #ffffff;
      --textBrand: #33374d;
      
      --bgForm: rgba(0, 0, 0, 0.3);
      --textForm: #ffffff;
      
      --bgSuccess: linear-gradient(135deg, #06d6a0, #1b9aaa);
      --bgError: linear-gradient(135deg, #ef476f, #b30f20);
      --bgOverlay: rgba(0, 0, 0, 0.7);

      /* Variables Derivadas (El CSS las calcula automáticamente) */
      --textBrandSecondary: color-mix(in srgb, var(--textBrand) 65%, transparent);
      --textFormSecondary: color-mix(in srgb, var(--textForm) 65%, transparent);
      --textFormDisabled: color-mix(in srgb, var(--textForm) 40%, transparent);
      
      --bgFormGlass: color-mix(in srgb, var(--textForm) 8%, transparent);
      --bgFormGlassHover: color-mix(in srgb, var(--textForm) 12%, transparent);
      --borderForm: color-mix(in srgb, var(--textForm) 10%, transparent);
      
      --shadowPrimary: color-mix(in srgb, var(--primaryColor) 30%, transparent);
      --shadowPrimaryHover: color-mix(in srgb, var(--primaryColor) 40%, transparent);
      --shadowFocus: color-mix(in srgb, var(--primaryColor) 15%, transparent);
    }

    /* ═══════════════════════════════════════════════════════════
       RESET & BASE
    ═══════════════════════════════════════════════════════════ */
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

html {
      height: 100%;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }

    body {
      min-height: 100vh;
      font-family: var(--font-sans);
      color: var(--textPage);
      background: var(--bgPage);
      overflow-x: hidden;
      position: relative;
    }

    /* ═══════════════════════════════════════════════════════════
       ANIMATED BACKGROUND
    ═══════════════════════════════════════════════════════════ */
.bg-animated {
  position: fixed;
  inset: 0;
  z-index: 0;
  background: var(--bg-page);
  overflow: hidden;
}


    @keyframes gradientShift {
      0%, 100% { transform: translate(0, 0) rotate(0deg); }
      50% { transform: translate(-10%, -10%) rotate(5deg); }
    }

    .bg-orbs {
      position: absolute;
      inset: 0;
      overflow: hidden;
      opacity: 0.6;
    }

    .orb {
      position: absolute;
      border-radius: 50%;
      filter: blur(80px);
      opacity: 0.5;
      animation: float 15s ease-in-out infinite;
      will-change: transform;
    }

.orb:nth-child(1) {
      width: 500px;
      height: 500px;
      background: radial-gradient(circle, var(--primaryColor) 0%, transparent 70%);
      top: -10%;
      left: -10%;
      animation-delay: 0s;
    }

    .orb:nth-child(2) {
      width: 400px;
      height: 400px;
      background: radial-gradient(circle, var(--secondaryColor) 0%, transparent 70%);
      bottom: -10%;
      right: -10%;
      animation-delay: 3s;
    }

    .orb:nth-child(3) {
      width: 350px;
      height: 350px;
      background: radial-gradient(circle, var(--primaryColor) 0%, transparent 70%);
      top: 50%;
      left: 50%;
      animation-delay: 6s;
    }

    @keyframes float {
      0%, 100% { transform: translate(0, 0) scale(1); }
      33% { transform: translate(30px, -30px) scale(1.1); }
      66% { transform: translate(-20px, 20px) scale(0.9); }
    }

    /* ═══════════════════════════════════════════════════════════
       LAYOUT CONTAINER
    ═══════════════════════════════════════════════════════════ */
    .container {
      position: relative;
      z-index: 1;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: clamp(1rem, 4vw, 2rem);
    }

    /* ═══════════════════════════════════════════════════════════
       MAIN CARD - Single Card with Two Columns
    ═══════════════════════════════════════════════════════════ */
    .main-card {
      width: 100%;
      max-width: 950px;
      background: var(--bgForm);
      backdrop-filter: blur(20px) saturate(180%);
      border: 1px solid var(--borderForm);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-lg);
      display: grid;
      grid-template-columns: 1fr 420px;
      overflow: hidden;
      animation: cardEnter 600ms var(--transition-smooth) backwards;
      will-change: transform, opacity;
    }

    @keyframes cardEnter {
      from {
        opacity: 0;
        transform: translateY(30px) scale(0.96);
      }
    }

    /* Left Column: Branding */
.brand-section {
      padding: 2.5rem;
      border-radius: var(--radius-lg) 0 0 var(--radius-lg);
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      background: var(--bgBrand);
      position: relative;
      overflow: hidden;
    }


    .brand-section .logo-container,
    .brand-section .logo-text,
    .brand-section .brand-title,
    .brand-section .brand-description,
    .brand-section #brandTitle,
    .brand-section #brandDescription,
    .brand-section .feature-item {
      color: var(--textBrand);
    }

    .brand-section .feature-icon {
      stroke: var(--textBrand);
    }

    .brand-section .brand-footer p,
    .brand-section .brand-footer small{
        color: var(--textBrandSecondary);
    }


    .brand-section::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -30%;
      width: 400px;
      height: 400px;
      background: radial-gradient(circle, var(--shadowPrimary) 0%, transparent 70%);
      border-radius: 50%;
      filter: blur(60px);
      pointer-events: none;
    }

  .logo-container {
      display: flex;
      align-items: center;
      gap: 1rem;
      position: relative;
      z-index: 1;
      max-height: 100px;
    }
    .fas{
        font-family: "Font Awesome 6 Free";
    }
    .logo-icon {
      width: 250px;
      max-height: 150px;
      background: transparent;
      border-radius: var(--radius-lg);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 900;
      font-size: 1.5rem;
      box-shadow: none;
    }

    .logo-text {
      font-size: clamp(.5rem, 1.3vw, 1rem);
      font-weight: 800;
      letter-spacing: -0.02em;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      text-align: center;
    }

    .brand-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 1.5rem;
      position: relative;
      z-index: 1;
    }

    .brand-title {
      font-size: clamp(2rem, 4vw, 3rem);
      font-weight: 900;
      line-height: 1.1;
      letter-spacing: -0.03em;
      color: var(--textBrand);
      -webkit-background-clip: text;
      background-clip: text;
    }

.brand-description {
      font-size: 1.125rem;
      line-height: 1.6;
      color: var(--textBrand);
      max-width: 480px;
    }

    .brand-features {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      margin-top: 1rem;
    }

    .feature-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      color: var(--textBrand);
      font-size: 0.95rem;
    }

    .feature-icon {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      color: var(--primaryColor);
    }

  .brand-footer {
      font-size: 0.875rem;
      color: var(--textBrandSecondary);
      position: relative;
      z-index: 1;
    }

    /* Right Column: Forms */
    .form-section {
      padding: clamp(1.5rem, 4vw, 2.5rem);
      background: var(--bgForm);
      display: flex;
      flex-direction: column;
      position: relative;
    }

    /* Tab Navigation */
    .tab-nav {
      display: flex;
      gap: 0.5rem;
      padding: 0.5rem;
      background: var(--bgFormGlass);
      border-radius: var(--radius-md);
      margin-bottom: 2rem;
      border: 1px solid var(--borderForm);
    }

  .tab-btn {
      flex: 1;
      padding: 0.75rem 1rem;
      border: none;
      background: transparent;
      color: var(--textFormSecondary);
      font-weight: 700;
      font-size: 0.875rem;
      letter-spacing: 0.03em;
      text-transform: uppercase;
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: all var(--transition-fast);
      position: relative;
      font-family: inherit;
    }

    .tab-btn:hover {
      background: var(--bgFormGlassHover);
      color: var(--textForm);
    }

    .tab-btn.active {
      background: linear-gradient(135deg, var(--primaryColor), var(--secondaryColor));
      color: #ffffff; /* Texto de botón activo/primario siempre blanco */
      box-shadow: 0 4px 12px var(--shadowPrimary);
    }

    /* Form Container */

    @keyframes flipIn {
      from { transform: rotateY(-70deg); opacity: 0; }
      to { transform: rotateY(0deg); opacity: 1; }
    }

.form-container {
      position: relative;
      flex: 1;
      display: flex;
      flex-direction: column;
      perspective: 1000px;
    }

    .login-form {
      display: none;
      flex-direction: column;
      gap: 1.25rem;
      flex: 1;
      transform: rotateY(0deg);
      opacity: 1;
      backface-visibility: hidden;
    }

    .login-form.active {
      display: flex;
      animation: flipIn 400ms var(--transition-smooth) forwards;
    }


    .form-title {
      font-size: 1.75rem;
      font-weight: 800;
      margin-bottom: 0.5rem;
      letter-spacing: -0.02em;
      color: var(--textForm);
    }

    .form-subtitle {
      color: var(--textFormSecondary);
      font-size: 0.95rem;
      margin-bottom: 1rem;
    }

    /* Form Fields */
    .form-group {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

.form-label {
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--textFormSecondary);
      letter-spacing: 0.01em;
    }

    .input-wrapper {
      position: relative;
    }

    .form-input {
      width: 100%;
      padding: 0.875rem 1rem;
      padding-left: 2.75rem;
      border-radius: var(--radius-sm);
      font-size: 1rem;
      font-family: inherit;
      transition: all var(--transition-fast);
      outline: none;
    }

    .input-icon {
      position: absolute;
      left: 0.875rem;
      top: 50%;
      transform: translateY(-50%);
      width: 20px;
      height: 20px;
      color: var(--textFormSecondary);
      pointer-events: none;
    }

    /* ═══════════════════════════════════════════════════════════
       INPUT THEME: DARK (Default)
    ═══════════════════════════════════════════════════════════ */
    body[data-input-theme="dark"] .form-input {
      background: var(--bgFormGlass);
      border: 1px solid var(--borderForm);
      color: var(--textForm);
    }
    body[data-input-theme="dark"] .form-input::placeholder {
      color: var(--textFormDisabled);
    }
    body[data-input-theme="dark"] .form-input:focus {
      background: var(--bgFormGlassHover);
      border-color: var(--primaryColor);
      box-shadow: 0 0 0 3px var(--shadowFocus);
    }

    /* ═══════════════════════════════════════════════════════════
       INPUT THEME: LIGHT
    ═══════════════════════════════════════════════════════════ */
    body[data-input-theme="light"] .form-input {
      background: #FFFFFF;
      border: 1px solid color-mix(in srgb, var(--textForm) 20%, transparent);
      color: var(--textForm);
    }
    body[data-input-theme="light"] .form-input::placeholder {
      color: color-mix(in srgb, var(--textForm) 40%, transparent);
    }
    body[data-input-theme="light"] .form-input:focus {
      background: #FFFFFF;
      border-color: var(--primaryColor);
      box-shadow: 0 0 0 3px var(--shadowFocus);
    }
    /* Buttons */
.btn {
      padding: 0.875rem 1.5rem;
      border: none;
      border-radius: var(--radius-sm);
      font-weight: 700;
      font-size: 1rem;
      cursor: pointer;
      transition: all var(--transition-fast);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      font-family: inherit;
      letter-spacing: 0.01em;
    }

.btn-primary {
      background: linear-gradient(135deg, var(--primaryColor), var(--secondaryColor));
      color: #ffffff; /* Texto de botón activo/primario siempre blanco */
      box-shadow: 0 8px 24px var(--shadowPrimary);
      position: relative;
      overflow: hidden;
    }

    .btn-primary::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, var(--primaryColor), var(--secondaryColor));
      opacity: 0;
      transition: opacity var(--transition-fast);
      filter: brightness(1.15);
    }

    .btn-primary:hover::before {
      opacity: 1;
    }

    .btn-primary span, .btn-primary svg {
      position: relative;
      z-index: 1;
    }
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 32px var(--shadowPrimaryHover);
    }

    .btn-primary:active {
      transform: translateY(0);
    }

    .btn-primary:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

.form-actions {
      display: flex;
      gap: 0.75rem;
      margin-top: 0.5rem;
    }

    .btn-block {
      width: 100%;
    }

    /* Links */
    .form-link {
      color: var(--primaryColor);
      text-decoration: none;
      font-size: 0.875rem;
      transition: all var(--transition-fast);
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
    }

    .form-link:hover {
      text-decoration: underline;
    }

  .form-footer {
      margin-top: auto;
      padding-top: 1.5rem;
      border-top: 1px solid var(--borderForm);
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      font-size: 0.875rem;
      color: var(--textFormSecondary);
    }

    /* ═══════════════════════════════════════════════════════════
       MODAL
    ═══════════════════════════════════════════════════════════ */
.modal-overlay {
      position: fixed;
      inset: 0;
      background: var(--bgOverlay);
      backdrop-filter: blur(8px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      padding: 1rem;
      animation: fadeIn 250ms var(--transition-smooth);
    }

    @keyframes fadeIn {
      from { opacity: 0; }
    }

    @keyframes fadeOut {
      to { opacity: 0; }
    }

    .modal-content {
      background: var(--bgForm); 
      backdrop-filter: blur(20px);
      border: 1px solid var(--borderForm);
      border-radius: var(--radius-lg);
      padding: 2rem;
      max-width: 400px;
      width: 100%;
      box-shadow: var(--shadow-lg);
      animation: modalEnter 350ms var(--transition-smooth);
      text-align: center;
    }

@keyframes modalEnter {
      from {
        opacity: 0;
        transform: scale(0.9) translateY(20px);
      }
    }

    .modal-icon {
      width: 56px;
      height: 56px;
      margin: 0 auto 1rem;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      color: #FFF;
    }

    .modal-icon.success {
      background: var(--bgSuccess);
    }

    .modal-icon.error {
      background: var(--bgError);
    }

    .modal-icon.info {
      background: linear-gradient(135deg, var(--primaryColor), var(--secondaryColor));
    }

    .modal-title {
      font-size: 1.5rem;
      font-weight: 800;
      margin-bottom: 0.5rem;
      color: var(--textForm);
    }

    .modal-text {
      color: var(--textFormSecondary);
      margin-bottom: 1.5rem;
      line-height: 1.5;
    }

    /* ═══════════════════════════════════════════════════════════
       RESPONSIVE
    ═══════════════════════════════════════════════════════════ */
@media (max-width: 968px) {
      .main-card {
        grid-template-columns: 1fr;
        max-width: 520px;
      }

      .brand-section {
        padding: 2rem; 
        background: none;
        justify-content: center;
        border-bottom: 1px solid var(--borderForm);
      }
      
      .brand-content,
      .brand-footer {
        display: none;
      }
      .brand-section::before {
        display: none;
      }

      .brand-section .logo-container {
        color: var(--textForm);
      }
      .brand-section .fas {
        color: var(--textForm);
      }
      .logo-icon {
        width: 40px; 
        height: 40px;
        font-size: 1.1rem;
        font-weight: 700;
        background: var(--bgFormGlass);
        border: 1px solid var(--borderForm);
        border-radius: var(--radius-sm);
        box-shadow: none;
        color: var(--textForm);
      }
      .logo-icon img {
          max-width: 80% !important;
          border-radius: var(--radius-sm) !important;
      }
    }

@media (max-width: 480px) {
      .container {
        padding: 1rem;
        align-items: flex-start;
        padding-top: 3rem;
      }
      .main-card {
        border-radius: var(--radius-md);
      }
      .form-actions {
        flex-direction: column;
      }
      .btn {
        width: 100%;
      }
      .tab-btn {
        font-size: 0.875rem;
        padding: 0.875rem 0.75rem;
      }
    }

    /* ═══════════════════════════════════════════════════════════
       UTILITIES
    ═══════════════════════════════════════════════════════════ */
    .hidden { display: none !important; }
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border-width: 0;
    }

    /* ═══════════════════════════════════════════════════════════
       MODAL FORM & PASSWORD VALIDATION
    ═══════════════════════════════════════════════════════════ */
    .modal-content.modal-form {
      max-width: 480px;
      text-align: left;
    }
    
    .modal-content.modal-form .modal-body {
      /* Clave para mobile: hace el formulario scrolleable */
      max-height: 65vh;
      overflow-y: auto;
      padding: 0.5rem 0.5rem 0.5rem 0;
      margin-top: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .modal-content .form-group {
      margin-bottom: 1.25rem;
    }
    
    .modal-content .form-input {
      background: var(--bgFormGlassHover);
      border: 1px solid var(--borderForm);
      color: var(--textForm);
    }
    
    .modal-content .form-input:focus {
      background: var(--bgFormGlass);
      border-color: var(--primaryColor);
      box-shadow: 0 0 0 3px var(--shadowFocus);
    }
    
    .modal-content .form-input::placeholder {
      color: var(--textFormDisabled);
    }
    
    .modal-content .form-input:read-only {
      background: var(--bgFormGlass);
      opacity: 0.7;
    }

    .password-rules {
      list-style: none;
      padding: 0;
      margin: 0.5rem 0 0 0;
      display: grid;
      /* Se adapta a mobile */
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 0.5rem;
      font-size: 0.875rem;
      color: var(--textFormSecondary);
    }
    
    .password-rules li {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: color 180ms ease-in-out;
    }
    
    .password-rules li::before {
      content: '○';
      font-size: 0.9rem;
      color: var(--textFormDisabled);
      transition: all 180ms ease-in-out;
    }
    
    .password-rules li.valid {
      color: var(--textForm);
    }
    
    .password-rules li.valid::before {
      content: '●';
      color: #06d6a0; /* Color de éxito */
      transform: scale(1.1);
    }

    .modal-actions {
      display: flex;
      flex-wrap: wrap; /* Para mobile */
      justify-content: flex-end;
      gap: 0.75rem;
      padding-top: 1.5rem;
      border-top: 1px solid var(--borderForm);
    }
    
    .btn-secondary {
      background: var(--bgFormGlass);
      color: var(--textForm);
      border: 1px solid var(--borderForm);
    }
    .btn-secondary:hover {
      background: var(--bgFormGlassHover);
    }
  </style>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>
  <!-- Animated Background -->
  <div class="bg-animated">
    <div class="bg-orbs">
      <div class="orb"></div>
      <div class="orb"></div>
      <div class="orb"></div>
    </div>
  </div>

  <!-- Main Container -->
  <div class="container">
    <div class="main-card" id="mainCard">
      
      <!-- LEFT: Branding Section -->
      <div class="brand-section">
        <div class="logo-container">
          <div class="logo-icon" id="logoIcon">AC</div>
          <i class="fas fa-graduation-cap"></i>
          <div class="logo-text" id="logoText"> Aula Corporativa</div>
        </div>

        <div class="brand-content">
          <h1 class="brand-title" id="brandTitle">¡Bienvenido!</h1>
          <p class="brand-description" id="brandDescription">
            Accede a tu plataforma de capacitación corporativa. Aprende, y mejorar tus habilidades profesionales.
          </p>
          <div class="brand-features" id="brandFeatures"></div>
        </div>

        <div class="brand-footer">
          <small>&copy; <span id="currentYear"></span> Aula Corporativa. Todos los derechos reservados.</small>
        </div>
      </div>

      <!-- RIGHT: Form Section -->
      <div class="form-section">
        <!-- Tab Navigation -->
        <nav class="tab-nav" role="tablist" aria-label="Tipo de usuario">
          <button class="tab-btn active" role="tab" aria-selected="true" data-tab="employees" id="tabEmployees">
            Trabajadores
          </button>
          <button class="tab-btn" role="tab" aria-selected="false" data-tab="contractors" id="tabContractors">
            Contratistas
          </button>
        </nav>

        <!-- Form Container -->
        <div class="form-container">
          
          <!-- Employees Form -->
          <form class="login-form active" id="formEmployees" role="tabpanel" aria-labelledby="tabEmployees">
            <div>
              <h2 class="form-title">Iniciar Sesión</h2>
              <p class="form-subtitle">Ingresa tu correo o ID</p>
            </div>

            <div class="form-group">
              <label class="form-label" for="empUsername" id="labelEmpUser">Usuario</label>
              <div class="input-wrapper">
                <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                </svg>
                <input 
                  type="text" 
                  id="empUsername" 
                  class="form-input" 
                  placeholder="usuario@empresa.com"
                  autocomplete="username"
                  required
                />
              </div>
            </div>

            <div class="form-group">
              <label class="form-label" for="empPassword" id="labelEmpPass">Contraseña</label>
              <div class="input-wrapper">
                <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                </svg>
                <input 
                  type="password" 
                  id="empPassword" 
                  class="form-input" 
                  placeholder="••••••••"
                  autocomplete="current-password"
                  required
                />
              </div>
            </div>

            <div class="form-actions">
              <button type="submit" class="btn btn-primary btn-block" id="btnLoginEmp">
                <span>Ingresar</span>
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                </svg>
              </button>
            </div>

            <div class="form-footer">
              <a href="#" class="form-link" id="forgotEmp">¿Olvidaste tu contraseña?</a>
              <div>¿No tienes cuenta? <a href="#" class="form-link" id="registerEmp">Regístrate aquí</a></div>
            </div>
          </form>

          <!-- Contractors Form -->
          <form class="login-form" id="formContractors" role="tabpanel" aria-labelledby="tabContractors">
            <div>
              <h2 class="form-title">Acceso Contratistas</h2>
              <p class="form-subtitle">Ingresa tu correo</p>
            </div>

            <div class="form-group">
              <label class="form-label" for="conUsername" id="labelConUser">ID Contratista</label>
              <div class="input-wrapper">
                <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2"/>
                </svg>
                <input 
                  type="text" 
                  id="conUsername" 
                  class="form-input" 
                  placeholder="contratista@empresa.com"
                  autocomplete="username"
                  required
                />
              </div>
            </div>

            <div class="form-group">
              <label class="form-label" for="conPassword" id="labelConPass">Contraseña</label>
              <div class="input-wrapper">
                <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                </svg>
                <input 
                  type="password" 
                  id="conPassword" 
                  class="form-input" 
                  placeholder="••••••••"
                  autocomplete="current-password"
                  required
                />
              </div>
            </div>

            <div class="form-actions">
              <button type="submit" class="btn btn-primary btn-block" id="btnLoginCon">
                <span>Ingresar</span>
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                </svg>
              </button>
            </div>

            <div class="form-footer">
              <a href="#" class="form-link" id="supportCon">Soporte para contratistas</a>
              <div>¿Problemas de acceso? <a href="#" class="form-link" id="helpCon">Contactar supervisor</a></div>
            </div>
          </form>

        </div>
      </div>

    </div>
  </div>

  <!-- Modal Root -->
  <div id="modalRoot" role="dialog" aria-live="polite"></div>

  <!-- Main JavaScript -->
<script>
  (function() {
    'use strict';

    const SUPABASE_URL = 'https://hvwygpnuunuuylzondxt.supabase.co'; 
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh2d3lncG51dW51dXlsem9uZHh0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA1NDUzMTEsImV4cCI6MjA3NjEyMTMxMX0.FxjCX9epT_6LgWGdzdPhRUTP2vn4CLdixRqpFMRZK70';

    // El cliente de Supabase ahora está disponible globalmente
    // La variable 'supabase' se usará para todas las llamadas (login, register, etc.)
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    // ═══════════════════════════════════════════════════════════
    // CONFIGURATION & DEFAULTS
    // ═══════════════════════════════════════════════════════════
    const DEFAULTS = {
      companyName: "Aula Corporativa",
      logoText: "AC",
      logoUrl: null,
      tagline: "¡Bienvenido!",
      description: "Accede a tu plataforma de capacitación corporativa. Aprende, crece y alcanza tus objetivos profesionales.",
      
      bgPage: "#141E30",
      textPage: "#ffffff",
      primaryColor: "#234B95",
      secondaryColor: "#1F3F7A",
      
      bgBrand: "#ffffff",
      textBrand: "#33374d",
      
      bgForm: "rgba(0, 0, 0, 0.3)",
      textForm: "#ffffff",
      inputTheme: "dark",

      bgSuccess: "linear-gradient(135deg, #06d6a0, #1b9aaa)",
      bgError: "linear-gradient(135deg, #ef476f, #b30f20)",
      bgOverlay: "rgba(0, 0, 0, 0.7)",

      backgroundImage: `linear-gradient(to bottom, #141E30, #243B55)`,
      animatedBackground: false,
            
      labels: {
        empUser: "Usuario",
        empPass: "Contraseña",
        conUser: "ID Contratista",
        conPass: "Contraseña"
      },
      
      successRedirect: "profile/profile.html",
      copyrightText: null,
      customCss: null
    };

    // ═══════════════════════════════════════════════════════════
    // UTILITY FUNCTIONS
    // ═══════════════════════════════════════════════════════════
    const $ = (selector) => document.querySelector(selector);
    const $$ = (selector) => Array.from(document.querySelectorAll(selector));
    
    const setStyle = (prop, value) => {
      if (value) {
        document.documentElement.style.setProperty(prop, value);
      }
    };
    
    const detectTenant = () => {
      const host = location.hostname || 'localhost';

      if (host === 'localhost') {
    return 'demo';
  }
  if (host === '127.0.0.1') {
    return 'default';
  }
      const parts = host.split('.');
      
      if (parts.length > 2 && parts[0] !== 'www') {
        return parts[0];
      }
      
      return host === 'localhost' ? 'demo' : 'default';
    };

    // ═══════════════════════════════════════════════════════════
    // TENANT LOADING
    // ═══════════════════════════════════════════════════════════
    const tenantId = detectTenant();
    
    async function loadTenantConfig() {
      try {
        const response = await fetch('./tenants/tenants.json', {
          cache: 'no-store',
          headers: { 'Accept': 'application/json' }
        });
        
        if (!response.ok) throw new Error('Tenant config not found');
        
        const data = await response.json();
        const tenantConfig = data[tenantId] || data['default'] || {};
        
        // Deep merge with defaults
        const config = {
          ...DEFAULTS,
          ...tenantConfig,
          labels: { ...DEFAULTS.labels, ...(tenantConfig.labels || {}) }
        };
        
        return config;
      } catch (error) {
        console.warn('⚠️ Tenant config not loaded, using defaults:', error);
        return DEFAULTS;
      }
    }

    // ═══════════════════════════════════════════════════════════
    // APPLY CONFIGURATION
    // ═══════════════════════════════════════════════════════════
    function applyConfiguration(config) {
      window.__appConfig = config;
      // 1. Aplicar las 10 variables "Maestras" al CSS
      setStyle('--bgPage', config.bgPage);
      setStyle('--textPage', config.textPage);
      
      setStyle('--primaryColor', config.primaryColor);
      setStyle('--secondaryColor', config.secondaryColor);
      
      setStyle('--bgBrand', config.bgBrand);
      setStyle('--textBrand', config.textBrand);
      
      setStyle('--bgForm', config.bgForm);
      setStyle('--textForm', config.textForm);
      
      setStyle('--bgSuccess', config.bgSuccess);
      setStyle('--bgError', config.bgError);
      setStyle('--bgOverlay', config.bgOverlay);

      // 2. Aplicar el "Interruptor" del Tema de Inputs
      document.body.dataset.inputTheme = config.inputTheme || 'dark';

      // 3. Aplicar el resto de la configuración (logo, textos, etc.)
      const logoIcon = $('#logoIcon');
      const logoText = $('#logoText');
      
    if (config.logoUrl) {
        logoIcon.innerHTML = `<img src="${config.logoUrl}" alt="Logo" style="max-width:100%; height: auto; object-fit:contain;" />`;
      } else {
        logoIcon.textContent = config.logoText;
      }
      
      logoText.textContent = config.companyName;

      $('#brandTitle').textContent = config.tagline;
      $('#brandDescription').textContent = config.description;

      const featuresContainer = $('#brandFeatures');
      if (featuresContainer && config.features && config.features.length > 0) {
        featuresContainer.innerHTML = config.features.map(feature => `
          <div class="feature-item">
            <svg class="feature-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
            <span>${feature}</span>
          </div>
        `).join('');
      } else if (featuresContainer) {
        featuresContainer.innerHTML = '';
      }

      $('#labelEmpUser').textContent = config.labels.empUser;
      $('#labelEmpPass').textContent = config.labels.empPass;
      $('#labelConUser').textContent = config.labels.conUser;
      $('#labelConPass').textContent = config.labels.conPass;

      $('#currentYear').textContent = new Date().getFullYear();

      if (config.backgroundImage) {
        $('.bg-animated').style.background = config.backgroundImage;
        $('.bg-animated').style.backgroundSize = 'cover';
        $('.bg-animated').style.backgroundPosition = 'center';
      }

      if (!config.animatedBackground) {
        $('.bg-orbs').style.display = 'none';
      }

      // 4. Aplicar CSS Personalizado (al final para que tenga más peso)
      if (config.customCss) {
        const link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = config.customCss;
        document.head.appendChild(link);
      }

      window.__loginRedirect = config.successRedirect;

      initializeInteractions();
    }

    // ═══════════════════════════════════════════════════════════
    // TAB SYSTEM
    // ═══════════════════════════════════════════════════════════
function initializeInteractions() {
      const tabButtons = $$('.tab-btn');
      const forms = $$('.login-form');
      const capitalize = (str) => str.charAt(0).toUpperCase() + str.slice(1);

      tabButtons.forEach(button => {
        button.addEventListener('click', () => {
          const targetTab = button.dataset.tab;
          const targetFormId = `form${capitalize(targetTab)}`;
          
          if (button.classList.contains('active')) return;

          // Actualizar botones
          tabButtons.forEach(btn => {
            const isActive = btn.dataset.tab === targetTab;
            btn.classList.toggle('active', isActive);
            btn.setAttribute('aria-selected', isActive);
          });

          // Actualizar formularios con animación
          let formToLeave = null;
          forms.forEach(form => {
            if (form.classList.contains('active')) {
              formToLeave = form;
            }
            form.classList.remove('is-leaving'); 
          });


forms.forEach(form => {
        form.classList.remove('active');
      });

      // Mostrar solo el formulario objetivo
      const formToEnter = $(`#${targetFormId}`);
      if (formToEnter) {
        formToEnter.classList.add('active');
      }
        });
      });

      // ═══════════════════════════════════════════════════════════
      // FORM SUBMISSIONS
      // (El resto de la función sigue igual...)
      // ═══════════════════════════════════════════════════════════
      
$('#formEmployees').addEventListener('submit', async (e) => {
    e.preventDefault();
    const username = $('#empUsername').value.trim();
    const password = $('#empPassword').value.trim();
    
    if (!username || !password) {
      showModal('Error', 'Por favor completa todos los campos', 'error');
      return;
    }
    
    const btn = $('#btnLoginEmp');
    btn.disabled = true;
    btn.querySelector('span').textContent = 'Ingresando...';

      try {
      // 1. Validar contraseña con Supabase
      const { data: authData, error: authError } = await supabase.auth.signInWithPassword({
        email: username,
        password: password,
      });

      if (authError) {
        throw authError; // Error de credenciales
      }
      const { data: profile, error: profileError } = await supabase
        .from('profiles')
        .select('autorizado')
        .eq('user_id', authData.user.id)
        .single();
      
      if (profileError) {
        throw new Error('No se pudo encontrar tu perfil de usuario.');
      }

      // 3. LA VERIFICACIÓN CLAVE
      if (!profile.autorizado) {
        // Si no está autorizado, mostrar error y CERRAR SESIÓN
        await supabase.auth.signOut();
        throw new Error('Tu cuenta aún no ha sido autorizada por un administrador.');
      }
      // 2. Si el login es exitoso
      showModal(
        '¡Bienvenido!',
        'Inicio de sesión exitoso. Redirigiendo...',
        'success',
        () => { 
          // Redirige a la página de perfil
          window.location.href = window.__loginRedirect || './profile/profile.html'; 
        }
      );

} catch (error) {
      // 5. Manejo de todos los errores
      btn.disabled = false;
      btn.querySelector('span').textContent = 'Ingresar';
      
      let userMessage = 'Ocurrió un error inesperado.';
      
      if (error.message.includes('Invalid login credentials')) {
        userMessage = 'Las credenciales de acceso no son válidas.';
      } else if (error.message.includes('Tu cuenta aún no ha sido autorizada')) {
         userMessage = 'Tu cuenta aún no ha sido autorizada. Contacta a un administrador.';
      } else if (error.message.includes('No se pudo encontrar tu perfil')) {
         userMessage = 'Error de login: No se encontró un perfil asociado a esta cuenta.';
      }
      
      showModal('Error de Acceso', userMessage, 'error');
    }
});

      $('#formContractors').addEventListener('submit', async (e) => {
        e.preventDefault();
        const username = $('#conUsername').value.trim();
        const password = $('#conPassword').value.trim();
        if (!username || !password) {
          showModal('Error', 'Por favor completa todos los campos', 'error');
          return;
        }
        const btn = $('#btnLoginCon');
        btn.classList.add('loading');
        btn.disabled = true;

        setTimeout(() => {
          btn.classList.remove('loading');
          btn.disabled = false;
          showModal(
            'Acceso Aprobado',
            'Redirigiendo a tu panel...',
            'success',
            () => { window.location.href = window.__loginRedirect || 'profile/profile.html'; }
          );
        }, 1000);
      });

      // ═══════════════════════════════════════════════════════════
      // LINK HANDLERS
      // (El resto de la función sigue igual...)
      // ═══════════════════════════════════════════════════════════
      
      $('#forgotEmp')?.addEventListener('click', (e) => {
        e.preventDefault();
        showModal(
          'Recuperar Contraseña',
          'Contacta al departamento de RRHH o utiliza la opción de recuperación de tu empresa.',
          'info'
        );
      });

      $('#registerEmp')?.addEventListener('click', (e) => {
        e.preventDefault();
        // Llama a la nueva función del modal de registro
        showRegistrationModal(); 
      });

      $('#supportCon')?.addEventListener('click', (e) => {
        e.preventDefault();
        showModal(
          'Soporte Contratistas',
          'Contacta a tu supervisor o al coordinador de contratistas para asistencia.',
          'info'
        );
      });

      $('#helpCon')?.addEventListener('click', (e) => {
        e.preventDefault();
        showModal(
          'Ayuda',
          'Para problemas de acceso, contacta directamente a tu supervisor.',
          'info'
        );
      });

      // Enter key submission
      ['empUsername', 'empPassword', 'conUsername', 'conPassword'].forEach(id => {
        $(`#${id}`)?.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') {
            e.preventDefault();
            const form = e.target.closest('form');
            form?.dispatchEvent(new Event('submit'));
          }
        });
      });
    }

    // ═══════════════════════════════════════════════════════════
    // MODAL SYSTEM
    // ═══════════════════════════════════════════════════════════
    function showModal(title, message, type = 'info', callback = null) {
      const modalRoot = $('#modalRoot');
      if (!modalRoot) return;

      const icons = {
        success: '✓',
        error: '✕',
        info: 'ℹ'
      };

      const modal = document.createElement('div');
      modal.className = 'modal-overlay';
      modal.innerHTML = `
        <div class="modal-content">
          <div class="modal-icon ${type}">
            ${icons[type] || icons.info}
          </div>
          <h3 class="modal-title">${title}</h3>
          <p class="modal-text">${message}</p>
          <button class="btn btn-primary" id="modalClose">Aceptar</button>
        </div>
      `;

      modalRoot.innerHTML = '';
      modalRoot.appendChild(modal);

      const closeModal = () => {
        modal.style.animation = 'fadeOut 200ms ease-out forwards';
        setTimeout(() => {
          modalRoot.innerHTML = '';
          if (callback) callback();
        }, 200);
      };

      $('#modalClose').addEventListener('click', closeModal);
      modal.addEventListener('click', (e) => {
        if (e.target === modal) closeModal();
      });

      const escapeHandler = (e) => {
        if (e.key === 'Escape') {
          closeModal();
          document.removeEventListener('keydown', escapeHandler);
        }
      };
      document.addEventListener('keydown', escapeHandler);
    }

    // ═══════════════════════════════════════════════════════════
    // REGISTRATION MODAL
    // ═══════════════════════════════════════════════════════════
    function showRegistrationModal() {
      const modalRoot = $('#modalRoot');
      if (!modalRoot) return;
      
      const config = window.__appConfig || DEFAULTS;
      const companyName = config.companyName || 'Tu Compañía';

      const modal = document.createElement('div');
      modal.className = 'modal-overlay';
      modal.innerHTML = `
        <div class="modal-content modal-form">
          <h3 class="modal-title">Solicitar Registro</h3>
          
          <div class="modal-body">
            <form id="registrationForm">
              <div class="form-group">
                <label class="form-label" for="regName">Nombre Completo</label>
                <input type="text" id="regName" class="form-input" placeholder="Tu nombre" required>
              </div>
              
              <div class="form-group">
                <label class="form-label" for="regCompany">Compañía</label>
                <input type="text" id="regCompany" class="form-input" value="${companyName}" readonly>
              </div>
              
              <div class="form-group">
                <label class="form-label" for="regArea">Área o Departamento</label>
                <input type="text" id="regArea" class="form-input" placeholder="Ej. Mantenimiento" required>
              </div>
              
              <div class="form-group">
                <label class="form-label" for="regEmail">Correo Electrónico</label>
                <input type="email" id="regEmail" class="form-input" placeholder="tu@correo.com" required>
              </div>
              
              <div class="form-group">
                <label class="form-label" for="regPassword">Crear Contraseña</label>
                <input type="password" id="regPassword" class="form-input" placeholder="••••••••" required>
                <ul class="password-rules">
                  <li id="rule-length">8+ Caracteres</li>
                  <li id="rule-number">1 Número</li>
                  <li id="rule-letter">1 Letra</li>
                </ul>
              </div>
              
              <div class="form-group">
                <label class="form-label" for="regConfirmPassword">Confirmar Contraseña</label>
                <input type="password" id="regConfirmPassword" class="form-input" placeholder="••••••••" required>
                <ul class="password-rules">
                   <li id="rule-match">Las contraseñas coinciden</li>
                </ul>
              </div>
            </form>
          </div>
          
          <div class="modal-actions">
            <button class="btn btn-secondary" id="modalCancel">Cancelar</button>
            <button class="btn btn-primary" id="modalSubmit">Enviar Solicitud</button>
          </div>
        </div>
      `;

      modalRoot.innerHTML = '';
      modalRoot.appendChild(modal);

      const closeModal = () => {
        modal.style.animation = 'fadeOut 200ms ease-out forwards';
        setTimeout(() => {
          modalRoot.innerHTML = '';
        }, 200);
      };

      // --- Lógica de Validación de Password ---
      const passInput = $('#regPassword');
      const confirmInput = $('#regConfirmPassword');
      const rules = {
        length: $('#rule-length'),
        number: $('#rule-number'),
        letter: $('#rule-letter'),
        match: $('#rule-match')
      };
      
      const validatePassword = () => {
        const pass = passInput.value;
        const confirm = confirmInput.value;
        
        const isLength = pass.length >= 8;
        const hasNumber = /\d/.test(pass);
        const hasLetter = /[a-zA-Z]/.test(pass);
        const isMatch = pass.length > 0 && pass === confirm;
        
        rules.length.classList.toggle('valid', isLength);
        rules.number.classList.toggle('valid', hasNumber);
        rules.letter.classList.toggle('valid', hasLetter);
        rules.match.classList.toggle('valid', isMatch);
        
        return isLength && hasNumber && hasLetter && isMatch;
      };
      
      passInput.addEventListener('input', validatePassword);
      confirmInput.addEventListener('input', validatePassword);
      
      // --- Acciones del Modal ---
      $('#modalCancel').addEventListener('click', closeModal);

$('#modalSubmit').addEventListener('click', async () => {
    const form = $('#registrationForm');
    const submitBtn = $('#modalSubmit');

    if (!form.checkValidity()) {
      showModal('Error', 'Por favor completa todos los campos requeridos.', 'error');
      return;
    }
    
    if (!validatePassword()) {
      showModal('Contraseña Inválida', 'Por favor revisa que tu contraseña cumpla los requisitos.', 'error');
      return;
    }
    
    try {
      submitBtn.disabled = true;
      submitBtn.textContent = 'Enviando...';

      const regName = $('#regName').value.trim();
      const regArea = $('#regArea').value.trim();
      const regEmail = $('#regEmail').value.trim();
      const regPassword = $('#regPassword').value;

      const { data: authData, error: authError } = await supabase.auth.signUp({
        email: regEmail,
        password: regPassword
      });

      if (authError) {
        throw authError; 
      }

      if (!authData.user) {
         throw new Error('No se pudo crear el usuario, por favor intente de nuevo.');
      }

      const { error: profileError } = await supabase.from('profiles')
        .update({
          nombre: regName,
          area_departamento: regArea,
          tenant_id: window.__appConfig.tenantUUID
        })
        .eq('user_id', authData.user.id);

      if (profileError) {
        throw profileError;
      }

      closeModal();
      setTimeout(() => {
         showModal(
          'Solicitud Enviada',
          'Tu solicitud ha sido enviada para autorización. Recibirás una notificación por correo.',
          'success'
        );
      }, 250);
              
    } catch (error) {
      submitBtn.disabled = false;
      submitBtn.textContent = 'Enviar Solicitud';
      
      let userMessage = 'Ocurrió un error inesperado. Por favor, inténtalo de nuevo.';
      
      if (error.message.includes('User already registered')) {
          userMessage = 'Este correo electrónico ya está registrado.';
      } else if (error.message.includes('password should be') || error.message.includes('Password should be')) {
          userMessage = 'La contraseña es muy débil. Debe tener al menos 6 caracteres.';
      } else if (error.message.includes('email') || error.message.includes('Email')) {
          userMessage = 'El formato del correo no es válido.';
      }
      
      showModal('Error en el Registro', userMessage, 'error');
    }
});

const escapeHandler = (e) => {
    if (e.key === 'Escape') {
      closeModal();
      document.removeEventListener('keydown', escapeHandler);
    }
  };
  document.addEventListener('keydown', escapeHandler);

}

    // ═══════════════════════════════════════════════════════════
    // INITIALIZATION
    // ═══════════════════════════════════════════════════════════
    async function init() {
      console.log(`🚀 Initializing tenant: ${tenantId}`);
      
      const config = await loadTenantConfig();
      applyConfiguration(config);

      try {
      const { data: tenantDB, error } = await supabase
      .from('tenants')
      .select('id') // Solo necesitamos el 'id' (UUID)
      .eq('name', tenantId) // Compara 'name' (ej. 'jnj')
      .single();

    if (error) {
      throw new Error(`Tenant '${tenantId}' no encontrado en la base de datos.`);
    }

    // Guarda el UUID en la configuración global para usarlo después
    window.__appConfig.tenantUUID = tenantDB.id;
    console.log(`✅ Tenant UUID cargado: ${window.__appConfig.tenantUUID}`);
    
  } catch (error) {
    console.error(error);
    // Muestra un error si el tenant no existe en la BD
    showModal(
      'Error de Configuración', 
      `El tenant '${tenantId}' no está configurado correctamente en la base de datos. Contacta a soporte.`, 
      'error'
    );
  }
      
      console.log('✅ Application ready');
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }

  })();
  </script>
</body>
</html>