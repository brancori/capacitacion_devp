# üìã Reglas de Desarrollo y Arquitectura - Aula Corporativa

Este documento define los est√°ndares obligatorios para la generaci√≥n y mantenimiento de c√≥digo en este proyecto. 

## 1. Arquitectura de Conexi√≥n (Supabase & Proxy)
El proyecto utiliza un **Proxy PHP** intermedio para asegurar las peticiones a Supabase.
- **NUNCA** se debe conectar directamente a la URL de Supabase (`supabase.co`) desde el frontend.
- **SIEMPRE** se debe usar la ruta relativa `/api` como endpoint.

## 2. Cliente Supabase Centralizado
La l√≥gica de conexi√≥n, manejo de cookies y configuraci√≥n del proxy est√° centralizada en un √∫nico archivo.

### ‚ùå LO QUE NO SE DEBE HACER (Anti-patrones):
* No importar `createClient` de `@supabase/supabase-js` en los scripts de las p√°ginas.
* No definir `SUPABASE_URL` ni `SUPABASE_ANON_KEY` en archivos individuales.
* No inicializar `supabase.createClient()` manualmente en `index.js`, `profile.js`, etc.

### ‚úÖ LA FORMA CORRECTA:
* **Dependencia:** Todos los scripts deben asumir que `window.supabase` ya existe y est√° configurado.
* **Acceso:** Se debe acceder a la instancia global usando:
    ```javascript
    const supabase = window.supabase;
    ```
* **√Åmbito (Scope):** Para evitar errores de carga (`undefined`), **nunca** declares `const supabase = window.supabase` en el √°mbito global (al inicio del archivo). Decl√°ralo **dentro** de las funciones as√≠ncronas, `mainInit`, o manejadores de eventos.

## 3. Estructura HTML Obligatoria
Para que el cliente centralizado funcione, los scripts en el HTML deben seguir este orden estricto:

```html
<script src="[https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2](https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2)"></script>

<script src="../componentes/supabase-client.js"></script> 
<script src="./mi-pagina.js"></script>