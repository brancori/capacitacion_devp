<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Perfil de Capacitación PRO</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="./profile.css">
    <link rel="stylesheet" href="../componentes/global.css">
</head>
<body>

    <!-- Top Navigation -->
    <nav class="top-navbar">
        <div class="logo-section">
            <h2 id="companyName"><i class="fas fa-graduation-cap"></i> TROX Academy</h2>
        </div>
        <div class="nav-actions">

            <button class="notification-btn" id="notificationBtn">
                <i class="fas fa-bell"></i>
                <span class="notification-badge">3</span>
            </button>
            <button class="theme-toggle" id="themeToggle">
                <i class="fas fa-moon"></i>
            </button>
            <!-- CORRECCIÓN: Cambiado de <button> a <a> para el enlace -->
            <a href="../index.html" class="btn btn-outline">
                <i class="fas fa-sign-out-alt"></i> Salir
            </a>
        </div>
    </nav>

    <div class="container">
        <!-- 'stats-grid' se movió dentro de 'content-area' -->

        <!-- Main Grid -->
        <div class="main-grid">
            <!-- Sidebar -->
            <div class="sidebar">
                <!-- Profile Card -->
                <div class="profile-card">
                    <div class="avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <h2 id="profileName">Cargando...</h2>
                    <p class="role">Contratista | ID: 789456</p>
                    
                    <div class="progress-donut">
                        <svg viewBox="0 0 150 150">
                            <circle class="progress-donut-bg" cx="75" cy="75" r="69"></circle>
                            <circle class="progress-donut-fg" cx="75" cy="75" r="69"></circle>
                        </svg>
                        <span class="progress-text">40%</span>
                    </div>
                    <p style="color: var(--primary); font-weight: 600; margin-bottom: 1rem;">
                        2 de 5 cursos completados
                    </p>
                    <button class="btn btn-primary" style="width: 100%;">
                        <i class="fas fa-user-edit"></i> Editar Perfil
                    </button>
                    <a href="../componentes/admin.html" class="btn btn-outline" id="manageUsersBtn" style="width: 100%; margin-top: 0.75rem; display: none;">
                        <i class="fas fa-users-cog"></i> Adminsitración<nav></nav>
                    </a>
                </div>

                <!-- Badges Card -->
                <div class="badges-card">
                    <h3><i class="fas fa-trophy"></i> Certificaciones</h3>
                    <div class="badges-grid">
                        <div class="badge earned" title="Certificación Obtenida">
                            <i class="fas fa-first-aid"></i>
                            <span>Brigadista P. Auxilios Leader</span>
                        </div>
                        <div class="badge" title="Requiere: Curso de Primeros Auxilios Avanzado">
                            <i class="fas fa-fire-extinguisher"></i>
                            <span>Combate Incendios Leader</span>
                        </div>
                        <div class="badge" title="Requiere: 3 cursos de calidad completados">
                            <i class="fas fa-certificate"></i>
                            <span>Quality Expert</span>
                        </div>
                        <div class="badge" title="Requiere: Curso de Trabajos en Altura Básico">
                            <i class="fas fa-hard-hat"></i>
                            <span>Alturas Instructor</span>
                        </div>
                        <div class="badge" title="Requiere: Alturas Básico + Intermedio + Rescate">
                            <i class="fas fa-mountain"></i>
                            <span>Espacios Confinados Instructor</span>
                        </div>
                        <div class="badge" title="Requiere: 10+ certificaciones profesionales">
                            <i class="fas fa-crown"></i>
                            <span>Líder HSE</span>
                        </div>
                    </div>
                    <button class="btn btn-outline" id="viewBadgesBtn" style="width: 100%; margin-top: 1rem; font-size: 0.9rem;">
                        <i class="fas fa-info-circle"></i> Ver Requisitos
                    </button>
                </div>

                <!-- Calendar Card -->
                <div class="calendar-card">
                    <h3><i class="far fa-calendar-alt"></i> Próximos Vencimientos</h3>
                    <div class="calendar-event urgent">
                        <div class="event-date">
                            <div class="day">30</div>
                            <div class="month">OCT</div>
                        </div>
                        <div class="event-details">
                            <h4>Inducción de Seguridad</h4>
                            <p>Vence en 3 días</p>
                        </div>
                    </div>
                    <div class="calendar-event">
                        <div class="event-date">
                            <div class="day">26</div>
                            <div class="month">NOV</div>
                        </div>
                        <div class="event-details">
                            <h4>Manejo de Químicos</h4>
                            <p>Vence en 30 días</p>
                        </div>
                    </div>
                    <div class="calendar-event">
                        <div class="event-date">
                            <div class="day">26</div>
                            <div class="month">DIC</div>
                        </div>
                        <div class="event-details">
                            <h4>Uso de Extintores</h4>
                            <p>Vence en 60 días</p>
                        </div>
                    </div>
                </div>
            </div> <!-- Cierre de .sidebar -->

            <!-- Main Content -->
            <div class="content-area">
                
                <!-- CORRECCIÓN: 'stats-grid' movido aquí dentro -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon total">
                            <i class="fas fa-book"></i>
                        </div>
                        <div class="stat-content">
                            <h3>5</h3>
                            <p>Cursos Totales</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon completed">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-content">
                            <h3>2</h3>
                            <p>Completados</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon pending">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-content">
                            <h3>2</h3>
                            <p>En Progreso</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon urgent">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="stat-content">
                            <h3>1</h3>
                            <p>Urgente</p>
                        </div>
                    </div>
                </div>

                <!-- Filter Bar -->
                <div class="filter-bar">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="searchInput" placeholder="Buscar cursos...">
                    </div>
                    <div class="filter-group">
                        <button class="filter-btn active" data-filter="all">Todos</button>
                        <button class="filter-btn" data-filter="urgent">Urgente</button>
                        <button class="filter-btn" data-filter="pending">Pendiente</button>
                        <button class="filter-btn" data-filter="completed">Completado</button>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="tabs">
                <div class="tab active" data-tab="catalog">Catálogo</div>
                <div class="tab" data-tab="assigned">Asignados</div>
                <div class="tab" data-tab="completed">Completados</div>
                </div>

                <div class="tab-content" id="assigned">
                    <div class="course-grid" id="assignedCourses"></div>
                </div>

                <div class="tab-content" id="completed">
                    <div class="course-grid" id="completedCourses"></div>
                </div>

                <!-- Tab Content: Assigned Courses -->
                <div class="tab-content active" id="assigned">
                <div class="course-grid" id="courseCardsContainer">
                    <!-- Los cursos estáticos de demo los puedes dejar o quitar -->
                </div>
                </div>

                <!-- Tab Content: Certificates -->
                <div class="tab-content" id="certificates">
                <div class="course-grid" id="courseCardsContainer"></div>
                </div>


                <!-- Tab Content: Timeline (Estaba fuera) -->
                <div class="tab-content" id="timeline">
                    <div class="timeline">
                        <div class="timeline-item">
                            <div class="timeline-content">
                                <div class="timeline-date">15 de Octubre, 2025</div>
                                <h3 style="color: var(--success); margin-bottom: 0.5rem;">
                                    <i class="fas fa-check-circle"></i> Curso Completado
                                </h3>
                                <p><strong>Política de Seguridad TROX</strong></p>
                                <p style="color: var(--text-secondary); font-size: 0.9rem;">
                                    Calificación obtenida: 95/100 | Certificado emitido
                                </p>
                            </div>
                        </div>

                        <div class="timeline-item">
                            <div class="timeline-content">
                                <div class="timeline-date">10 de Octubre, 2025</div>
                                <h3 style="color: var(--warning); margin-bottom: 0.5rem;">
                                    <i class="fas fa-play-circle"></i> Curso Iniciado
                                </h3>
                                <p><strong>Inducción de Seguridad (Contratistas)</strong></p>
                                <p style="color: var(--text-secondary); font-size: 0.9rem;">
                                    En progreso: 60% completado
                                </p>
                            </div>
                        </div>

                        <div class="timeline-item">
                            <div class="timeline-content">
                                <div class="timeline-date">1 de Septiembre, 2025</div>
                                <h3 style="color: var(--success); margin-bottom: 0.5rem;">
                                    <i class="fas fa-check-circle"></i> Curso Completado
                                </h3>
                                <p><strong>COVID-19: Protocolo de Acceso</strong></p>
                                <p style="color: var(--text-secondary); font-size: 0.9rem;">
                                    Calificación obtenida: 100/100 | Certificado emitido
                                </p>
                            </div>
                        </div>

                        <div class="timeline-item">
                            <div class="timeline-content">
                                <div class="timeline-date">25 de Agosto, 2025</div>
                                <h3 style="color: var(--primary); margin-bottom: 0.5rem;">
                                    <i class="fas fa-user-plus"></i> Registro en Plataforma
                                </h3>
                                <p><strong>Bienvenido a TROX Academy</strong></p>
                                <p style="color: var(--text-secondary); font-size: 0.9rem;">
                                    Tu cuenta ha sido activada correctamente
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab Content: Recommendations (Estaba fuera) -->
                <div class="tab-content" id="recommendations">
                    <h2 style="margin-bottom: 1rem; color: var(--primary);">
                        <i class="fas fa-magic"></i> Cursos Recomendados Para Ti
                    </h2>
                    <p style="color: var(--text-secondary); margin-bottom: 2rem;">
                        Basado en tu perfil, historial y cursos completados
                    </p>
                    
                    <div class="recommendations-grid">
                        <!-- Recommendation 1 -->
                        <div class="recommendation-card">
                            <div class="rec-header">
                                <div class="rec-icon">
                                    <i class="fas fa-hard-hat"></i>
                                </div>
                                <div>
                                    <h3 style="margin-bottom: 0.25rem;">Seguridad en Alturas</h3>
                                    <p style="font-size: 0.85rem; color: var(--text-secondary);">
                                        Nivel Intermedio
                                    </p>
                                </div>
                                <span class="match-score">92%</span>
                            </div>
                            <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;">
                                Continuación ideal después de completar Inducción de Seguridad
                            </p>
                            <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem; flex-wrap: wrap;">
                                <span style="background: #e6f0ff; color: var(--primary); padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.8rem;">
                                    6 horas
                                </span>
                                <span style="background: #e6f0ff; color: var(--primary); padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.8rem;">
                                    Certificación
                                </span>
                            </div>
                            <button class="btn btn-success btn-enroll" data-course="Seguridad en Alturas" style="width: 100%;">
                                <i class="fas fa-plus-circle"></i> Inscribirme
                            </button>
                        </div>

                        <!-- Recommendation 2 -->
                        <div class="recommendation-card">
                            <div class="rec-header">
                                <div class="rec-icon">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <div>
                                    <h3 style="margin-bottom: 0.25rem;">EPP Avanzado</h3>
                                    <p style="font-size: 0.85rem; color: var(--text-secondary);">
                                        Nivel Avanzado
                                    </p>
                                </div>
                                <span class="match-score">88%</span>
                            </div>
                            <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;">
                                Especializacióncomplementaria a tus cursos actuales
                            </p>
                            <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem; flex-wrap: wrap;">
                                <span style="background: #e6f0ff; color: var(--primary); padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.8rem;">
                                    4 horas
                                </span>
                                <span style="background: #e6f0ff; color: var(--primary); padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.8rem;">
                                    Práctico
                                </span>
                            </div>
                            <button class="btn btn-success btn-enroll" data-course="EPP Avanzado" style="width: 100%;">
                                <i class="fas fa-plus-circle"></i> Inscribirme
                            </button>
                        </div>

                        <!-- Recommendation 3 -->
                        <div class="recommendation-card">
                            <div class="rec-header">
                                <div class="rec-icon">
                                    <i class="fas fa-bolt"></i>
                                </div>
                                <div>
                                    <h3 style="margin-bottom: 0.25rem;">Riesgo Eléctrico</h3>
                                    <p style="font-size: 0.85rem; color: var(--text-secondary);">
                                        Nivel Básico
                                    </p>
                                </div>
                                <span class="match-score">85%</span>
                            </div>
                            <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;">
                                Muy solicitado en tu área de trabajo
                            </p>
                            <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem; flex-wrap: wrap;">
                                <span style="background: #e6f0ff; color: var(--primary); padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.8rem;">
                                    3 horas
                                </span>
                                <span style="background: #e6f0ff; color: var(--primary); padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.8rem;">
                                    Popular
                                </span>
                            </div>
                            <button class="btn btn-success btn-enroll" data-course="Riesgo Eléctrico" style="width: 100%;">
                                <i class="fas fa-plus-circle"></i> Inscribirme
                            </button>
                        </div>
                    </div>
                </div>
            </div> <!-- Cierre de .content-area -->
        </div> <!-- Cierre de .main-grid -->
    </div> <!-- Cierre de .container -->

    <!-- Modal (Estaba fuera) -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <div class="modal-icon" id="modalIcon"></div>
            <h3 id="modalTitle"></h3>
            <p id="modalMessage"></p>
            <button class="btn btn-primary" id="modalClose" style="width: 100%;">Aceptar</button>
        </div>
    </div>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="../componentes/supabase-client.js"></script>
<script src="./profile.js"></script>
</body>
</html>